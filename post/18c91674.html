<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Aferica的个人博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://http://www.aferica.site">
    <!--SEO-->

    <meta name="keywords" content="CloudFlare,Https">


    <meta name="description" content="前言作为一位程序员，尤其是一位前端程序员，拥有一个自己的网站或者博客是很平常的一件事。无论作为自己的自由地，肆意发挥和实现自己的创意或者想法，还是作为展示自己的窗口，都很不错。作为一个私人网站，...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>使用CloudFlare为自己的网站保驾护航 | Aferica的个人博客</title>


    <link rel="alternate" href="/atom.xml" title="Aferica的个人博客" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    





    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header" style="background-image:url(https://api.aferica.site/common/tool/bing/image)">
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="aferica">
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> aferica </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://http://www.aferica.site">Aferica的个人博客</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/前端/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/后端/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/工具/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/API/"><i class="fa "></i>API</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Flutter/"><i class="fa "></i>Flutter</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="使用CloudFlare为自己的网站保驾护航">
            
	            使用CloudFlare为自己的网站保驾护航
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/云服务/">云服务</a> <a class="category-link" href="/categories/云服务/CloudFlare/">CloudFlare</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/CloudFlare/">CloudFlare</a> <a class="tag-link" href="/tags/Https/">Https</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/07/30</span>
        </span>
        
    
</div>
            
            
    </div>
    
    <div class="post-body post-content">
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>作为一位程序员，尤其是一位前端程序员，拥有一个自己的网站或者博客是很平常的一件事。无论作为自己的自由地，肆意发挥和实现自己的创意或者想法，还是作为展示自己的窗口，都很不错。<br>作为一个私人网站，我们不可能，也没有时间去注意网络安全，但是，一旦发生，后果有可能十分严重。<br>另外，大多数人应该都只有一个域名或者一个自己的服务器，有些内容是自己想要展示的，另外一些又是自己想要隐藏的，防止有心之人通过展示的部分获取到服务器地址，从而给自己造成一些麻烦也是很有必要的，这就需要推荐这篇博客的主角————CloudFlare。<br><br></p>
<h1 id="友情提示（重要）"><a href="#友情提示（重要）" class="headerlink" title="友情提示（重要）"></a>友情提示（重要）</h1><p><font color="red">由于CloudFlare是一家国外的云服务提供商，在国内访问速度受到比较明显的影响，因此，如果你觉得速度大于安全的话，并不推荐你使用。</font><br><br></p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190730154814.png" alt="20190730154814.png"><br>Cloudflare以向客户提供网站安全管理、性能优化及相关的技术支持为主要业务，帮助网站阻止来自网络的黑客攻击、垃圾邮件等，并提升网页的浏览速度。<br>官网：<a href="https://www.cloudflare.com/" target="_blank" rel="noopener">https://www.cloudflare.com/</a><br><br></p>
<h1 id="使用教程"><a href="#使用教程" class="headerlink" title="使用教程"></a>使用教程</h1><h2 id="1-注册-登录"><a href="#1-注册-登录" class="headerlink" title="1. 注册/登录"></a>1. 注册/登录</h2><p>这个就不多描述了</p>
<h2 id="2-添加自己的域名"><a href="#2-添加自己的域名" class="headerlink" title="2. 添加自己的域名"></a>2. 添加自己的域名</h2><p>点击右上角”Add site”，添加域名<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801111250.png" alt="20190801111250.png"><br>点击<code>Next</code>，Cloudflare会自动查找该域名下的DNS记录并导入<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801111330.png" alt="20190801111330.png"><br>选择套餐，免费版就可以了（当然，如果你是土豪，任意就好），点击<code>Confirm plan</code>确认<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801111524.png" alt="20190801111524.png"><br>弹框点击<code>Confirm</code>确认<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801111634.png" alt="20190801111634.png"><br>点击<code>Continue</code>继续<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801111827.png" alt="20190801111827.png"></p>
<p><font color="red">关键步骤：更改自己域名的DNS解析地址</font>，点击<code>Continue</code>继续（可稍后在改，直接继续）<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801112006.png" alt="20190801112006.png"><br>进入控制台主页</p>
<h2 id="3-配置"><a href="#3-配置" class="headerlink" title="3. 配置"></a>3. 配置</h2><h3 id="3-1-等待DNS解析地址更新"><a href="#3-1-等待DNS解析地址更新" class="headerlink" title="3.1 等待DNS解析地址更新"></a>3.1 等待DNS解析地址更新</h3><p>当出现下图中的<code>Complete your nameserver setup</code>提示，代表DNS解析地址未设置成Cloudflare地址，或未更新<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801112259.png" alt="20190801112259.png"><br>在上面更改DNS解析地址后，点击<code>Re-check now</code>重新检查状态<br>返回主页<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801112650.png" alt="20190801112650.png"><br>Active代表DNS解析地址更新成功，可以使用<br>Pending Nameserver Update代表DNS解析地址未更新，暂不可用</p>
<h3 id="3-2-DNS解析配置"><a href="#3-2-DNS解析配置" class="headerlink" title="3.2 DNS解析配置"></a>3.2 DNS解析配置</h3><p>点击上方第三个<code>DNS</code>菜单，进入DNS解析配置页面<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801112910.png" alt="20190801112910.png"><br>点击<code>Add Record</code>可以添加记录<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801113025.png" alt="20190801113025.png">代表使用Cloudflare的功能，如防攻击，https等<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801113110.png" alt="20190801113110.png">代表不使用，仅仅只作为DNS解析服务器</p>
<h3 id="3-3-Https加密"><a href="#3-3-Https加密" class="headerlink" title="3.3 Https加密"></a>3.3 Https加密</h3><p>点击上方第三个<code>Crypto</code>菜单<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801113334.png" alt="20190801113334.png">   </p>
<h4 id="3-3-1-SSL"><a href="#3-3-1-SSL" class="headerlink" title="3.3.1 SSL"></a>3.3.1 SSL</h4><p>如上图，可选四种模式，分别含义<br>Off：不使用加密连接<br>Flexible：您的网站访问者和Cloudflare之间有加密连接，但是从Cloudflare到您的服务器没有加密。即半程加密。优点在于：你的网站不需要SSL证书，用户也能实现SSL加密访问。<br>Full：全程加密，即从你的网站到CDN服务器再到用户，全程都是SSL加密的。优点在于：只要你的服务器有SSL证书（不管是自签名证书还是购买的SSL），就可以实现SSL加密访问。<br>Full(strict)：全程加密，它与Full SSL的区别在于你的服务器必须是安装了那些已经受信任的SSL证书（即购买的SSL证书），否则无法开启SSL加密访问。</p>
<div align="center"><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801150851.png"></div>

<h4 id="3-3-2-Origin-Certificates"><a href="#3-3-2-Origin-Certificates" class="headerlink" title="3.3.2 Origin Certificates"></a>3.3.2 Origin Certificates</h4><p><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801151258.png" alt="20190801151258.png"><br>由于使用Full或者Full(strict)都需要在服务器安装证书，如果你有多个子域名，并且都想使用https，那么这项功能对你来说十分方便<br>如上图示例，我添加了7个子域名（可以共用一个证书），有效期15年（完全不用考虑过期问题），简直不要太舒服</p>
<ol>
<li>点击<code>Create Certificate</code>按钮开始创建</li>
<li>输入自己想要添加的域名，如果想要添加子域名，例如api，只需要输入api后点击回车即可<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801151909.png" alt="20190801151909.png"></li>
<li>选择时长（很显然，当然选择15年了）</li>
<li>点击Next按钮生成</li>
<li>生成弹框中，将<code>Origin Certificate</code>内容保存为<code>xxx.pem</code>文件，将<code>Private key</code>内容保存为<code>xxx.key</code>文件（如果没有<code>Private key</code>，重新生成即可）</li>
<li>配置Nginx<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen 443;</span><br><span class="line">	server_name xxx.xxx;  // 域名或者子域名</span><br><span class="line"></span><br><span class="line">	ssl on;</span><br><span class="line">	ssl_certificate xxx.pem; // 上保存的.pem文件的全路径</span><br><span class="line">	ssl_certificate_key xxx.key; // 上保存的.key文件的全路径</span><br><span class="line">	ssl_session_timeout 5m;</span><br><span class="line">	ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #按照这个协议配置</span><br><span class="line">	ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;</span><br><span class="line"><span class="meta">	#</span><span class="bash">按照这个套件配置</span></span><br><span class="line">	ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">	client_max_body_size 20m;</span><br><span class="line"></span><br><span class="line">	// 网页路径配置</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-3-3-Always-Use-HTTPS"><a href="#3-3-3-Always-Use-HTTPS" class="headerlink" title="3.3.3 Always Use HTTPS"></a>3.3.3 Always Use HTTPS</h4><p>自动将Http请求重定向为Https，默认关闭</p>
<h4 id="3-3-4-Automatic-HTTPS-Rewrites"><a href="#3-3-4-Automatic-HTTPS-Rewrites" class="headerlink" title="3.3.4 Automatic HTTPS Rewrites"></a>3.3.4 Automatic HTTPS Rewrites</h4><p>会将网站使用http请求的数据如cdn，js文件等使用https请求，默认关闭</p>
<h3 id="3-4-配置过程中遇到问题"><a href="#3-4-配置过程中遇到问题" class="headerlink" title="3.4 配置过程中遇到问题"></a>3.4 配置过程中遇到问题</h3><p>在配置时，由于生效需要一定时间（官方说是24小时），所以如果出现浏览器找到地址，或者<code>ERR_SSL_PROTOCOL_ERROR</code>错误，以及一些莫名其妙的问题，请等待</p>
<h1 id="测试对速度的影响"><a href="#测试对速度的影响" class="headerlink" title="测试对速度的影响"></a>测试对速度的影响</h1><p>开篇就提到了，使用CloudFlare会对速度有些影响，具体测试：<br>不使用(3.2中配置)：平均速度16ms<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801153603.png" alt="20190801153603.png"><br>使用后(3.2中配置)：平均速度177ms<br><img src="https://aferica.oss-cn-shenzhen.aliyuncs.com/markdown/20190801153811.png" alt="20190801153811.png"><br>影响速度比较明显，所以具体是否使用，请结合自身实际</p>

    </div>
    
        <div class="reward" ontouchstart>
    <div class="reward-wrap">赏
        <div class="reward-box">
            
            
                <span class="reward-type">
                    <img class="wechat" src="https://aferica.oss-cn-shenzhen.aliyuncs.com/me/1561710559.jpg"><b>微信打赏</b>
                </span>
            
        </div>
    </div>
    <p class="reward-tip">你的赞赏是对我最大的鼓励</p>
</div>


    
    <div class="post-footer">
        <div>
            
                转载声明：转载请注明出处
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/post/8aa1c451.html" class="pre-post btn btn-default" title="Flutter学习（六）：视频播放">
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Flutter学习（六）：视频播放</span>
        </a>
    
    
        <a href="/post/eee036c1.html" class="next-post btn btn-default" title="好用软件推荐-Windows篇">
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">好用软件推荐-Windows篇</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: '0a6Qjjl2gHvSqkPF7iglNNvf-gzGzoHsz',
            appKey: 'UKINFuSGgUOwjl6Ez9silbs8',
            placeholder: '说点什么吧',
            notify: false,
            verify: false,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#友情提示（重要）"><span class="toc-text">友情提示（重要）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简介"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用教程"><span class="toc-text">使用教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-注册-登录"><span class="toc-text">1. 注册/登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-添加自己的域名"><span class="toc-text">2. 添加自己的域名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-配置"><span class="toc-text">3. 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-等待DNS解析地址更新"><span class="toc-text">3.1 等待DNS解析地址更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-DNS解析配置"><span class="toc-text">3.2 DNS解析配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Https加密"><span class="toc-text">3.3 Https加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-SSL"><span class="toc-text">3.3.1 SSL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-Origin-Certificates"><span class="toc-text">3.3.2 Origin Certificates</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-Always-Use-HTTPS"><span class="toc-text">3.3.3 Always Use HTTPS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-4-Automatic-HTTPS-Rewrites"><span class="toc-text">3.3.4 Automatic HTTPS Rewrites</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-配置过程中遇到问题"><span class="toc-text">3.4 配置过程中遇到问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#测试对速度的影响"><span class="toc-text">测试对速度的影响</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2019
                </span> |
                <span>
                  <a href="http://www.miitbeian.gov.cn/" class="copyright-links" target="_blank" rel="nofollow">粤ICP备18008014号</a>
                </span>
                <!-- <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span> -->
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>